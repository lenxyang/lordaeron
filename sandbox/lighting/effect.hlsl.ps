// using row_major
#pragma pack_matrix(row_major)

#include "lordaeron/effect/lighting.hlsl"

struct VsOutput {
  float4 position:SV_POSITION;
  float3 normal:NORMAL;
  float3 viewin: VIEWIN;
};

cbuffer c_buffer {
   DirLight dirlight;
   PointLight pointlight;
   float4 color;	
};


float4 ps_main(VsOutput o):SV_TARGET {
  Matrial mtrl;
  mtrl.ambient = float4(0.01, 0.01, 0.01, 1.0);
  mtrl.specular = float4(0.8, 0.8, 0.8, 1.0);
  mtrl.diffuse = color;
  mtrl.emission = float4(0.0f, 0.0f, 0.0f, 0.0f);
  mtrl.power = 32;
  mtrl.alpha = 1.0f;

  // float3 dir_color = CalcDirLightColor(dirlight, o.normal, o.viewin, mtrl);
  float3 point_color = CalcPointLightColor(pointlight, o.position.xyz,
                                           o.normal, o.viewin, mtrl);
  return float4(point_color, mtrl.alpha);
}
